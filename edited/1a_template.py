# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2022-11-29 12:11:03
"""
import arcpy
import os
from _1b_add_fields import AddFields2 # importable scripts as modules in other scripts can't start with a number, so we add a '_' to script name
from sys import argv

def WFRTFtemplate():  # 1a Template

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False


    # Process: Create Feature Class (Create Feature Class) (management)
    # TODO: try except to catch already exists error for feature dataset b_Reference and for the WFR_TF_Template featureclass
    WFRTF_Template = arcpy.management.CreateFeatureclass(out_path=os.path.join(workspace,'b_Reference'), out_name="WFR_TF_Template", geometry_type="POLYGON", template=[], has_m="DISABLED", has_z="DISABLED", spatial_reference="PROJCS[\"NAD_1983_California_Teale_Albers\",GEOGCS[\"GCS_North_American_1983\",DATUM[\"D_North_American_1983\",SPHEROID[\"GRS_1980\",6378137.0,298.257222101]],PRIMEM[\"Greenwich\",0.0],UNIT[\"Degree\",0.0174532925199433]],PROJECTION[\"Albers\"],PARAMETER[\"False_Easting\",0.0],PARAMETER[\"False_Northing\",-4000000.0],PARAMETER[\"Central_Meridian\",-120.0],PARAMETER[\"Standard_Parallel_1\",34.0],PARAMETER[\"Standard_Parallel_2\",40.5],PARAMETER[\"Latitude_Of_Origin\",0.0],UNIT[\"Meter\",1.0]];-16909700 -8597000 10000;#;#;0.001;#;#;IsHighPrecision", config_keyword="", spatial_grid_1=0, spatial_grid_2=0, spatial_grid_3=0, out_alias="")[0]

    # Process: 1b Add Fields (1b Add Fields) (PC414CWIMillionAcres)
    WFRTF_Template_5_ = AddFields2(Input_Table=WFRTF_Template)[0]

    return WFRTF_Template

if __name__ == '__main__':
    # make workspace and scratchWorkspace dynamic, not-hardcoded paths
    workspace = os.path.join(f"{os.path.dirname(os.path.dirname(__file__))}","PC414 CWI Million Acres LocalTesting.gdb")
    scratch_workspace = os.path.join(f"{os.path.dirname(os.path.dirname(__file__))}","scratch.gdb")
    
    for w in [workspace,scratch_workspace]:
        if not os.path.exists(w):
            print(f'Creating new FileGDB: {w}')
            arcpy.management.CreateFileGDB(os.path.dirname(w), os.path.basename(w))
    
    # Global Environment settings
    # fix sntax errors in extent and outputCoordinateSystem by wrapping in triple quotes
    with arcpy.EnvManager(
    extent="""-124.415162172178 32.5342699477235 -114.131212866967 42.0095193288898 GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]""", 
    outputCoordinateSystem="""PROJCS["NAD_1983_California_Teale_Albers",GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137.0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",-4000000.0],PARAMETER["Central_Meridian",-120.0],PARAMETER["Standard_Parallel_1",34.0],PARAMETER["Standard_Parallel_2",40.5],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]""", 
    preserveGlobalIds=True, 
    qualifiedFieldNames=False, 
    scratchWorkspace=scratch_workspace, 
    transferDomains=True, 
    transferGDBAttributeProperties=True, 
    workspace=workspace):
        
        WFRTFtemplate()
